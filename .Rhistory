load("~/R/sizestuff/LAEnvwithSizeclass.RData")
library(survival)
kmdab=read.csv("KMdataDabob.csv")
names(kmdab)
with(kmdab, tapply(Death[Status==1],Population[Status==1],mean))
with(kmdab, tapply(Death[Status==1],Population[Status==1],var))
fit1=with(kmdab,survfit(Surv(Death,Status)~Population))
plot(fit1, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving")
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
kmman=read.csv("KMdataMan.csv")
names(kmman)
with(kmman, tapply(Death[Status==1],Population[Status==1],mean))
with(kmman, tapply(Death[Status==1],Population[Status==1],var))
fit2=with(kmman, survfit(Surv(Death,Status)~Population))
plot(fit2, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving")
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
kmfid=read.csv("KMdataFid.csv")
with(kmfid, tapply(Death[Status==1],Population[Status==1],mean))
with(kmfid, tapply(Death[Status==1],Population[Status==1],var))
fit3=with(kmfid, survfit(Surv(Death,Status)~Population))
plot(fit3, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving")
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
kmoys=read.csv("KMdataOys.csv")
with(kmoys, tapply(Death[Status==1],Population[Status==1],mean))
with(kmoys, tapply(Death[Status==1],Population[Status==1],var))
fit4=with(kmoys, survfit(Surv(Death,Status)~Population))
plot(fit4, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving")
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
?axis
plot(fit1, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3, xaxt="n" )
axis(1, xaxp=c(0,2,4,6,8,10))
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
plot(fit1, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3, xaxt="n" )
axis(1, at=c(0,2,4,6,8,10),labels=T)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
plot(fit1,xaxt="n", col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3)
plot(fit1, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3)
axis(1, at=c(0,2,4,6,8,10),labels=T)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
plot(fit1,xlim=(0,10) col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3)
plot(fit1,xlim=c(0,10) col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3)
plot(fit1,xlim=c(0,10), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=3)
plot(fit1,xlim=c(0,10), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=10)
plot(fit1,xlim=c(0,10), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=5)
plot(fit1,xlim=c(0,10), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=1)
plot(fit1,xlim=c(0,10), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
library(survival)
kmdab=read.csv("KMdataDabob.csv")
names(kmdab)
with(kmdab, tapply(Death[Status==1],Population[Status==1],mean))
with(kmdab, tapply(Death[Status==1],Population[Status==1],var))
fit1=with(kmdab,survfit(Surv(Death,Status)~Population))
plot(fit1,xlim=c(0,10), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
kmman=read.csv("KMdataMan.csv")
names(kmman)
with(kmman, tapply(Death[Status==1],Population[Status==1],mean))
with(kmman, tapply(Death[Status==1],Population[Status==1],var))
fit2=with(kmman, survfit(Surv(Death,Status)~Population))
plot(fit2, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
kmfid=read.csv("KMdataFid.csv")
with(kmfid, tapply(Death[Status==1],Population[Status==1],mean))
with(kmfid, tapply(Death[Status==1],Population[Status==1],var))
fit3=with(kmfid, survfit(Surv(Death,Status)~Population))
plot(fit3, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
kmoys=read.csv("KMdataOys.csv")
with(kmoys, tapply(Death[Status==1],Population[Status==1],mean))
with(kmoys, tapply(Death[Status==1],Population[Status==1],var))
fit4=with(kmoys, survfit(Surv(Death,Status)~Population))
plot(fit4, col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
plot(fit1,xlim=c(0,11), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
plot(fit1,xlim=c(0,12), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
plot(fit1,xlim=c(0,11), col=c("#3366CC","#CC66CC","#FF9900"), xlab="Survival Time from Outplant in Months", ylab="% Surviving", lwd=2)
legend("bottomleft", title="Population", c("Dabob","Fidalgo","Oyster Bay"), fill=c("#3366CC","#CC66CC","#FF9900"))
ggplot(data=manrep, aes(x=Date, y=Percent, group=Pop, colour=Pop, fill=Pop))+geom_line(size=1.5)+geom_point()+ylim(c(0,15))+scale_colour_manual(values=c("#3366CC","#CC66CC","#FF9900"))+scale_fill_manual(values=c("#3366CC","#CC66CC","#FF9900"))+theme(axis.text.x=element_text(angle=90, size=10, vjust=0.5))+ggtitle("Percent Brooders\nManchester")+theme(legend.title=element_blank())+theme(plot.title = element_text(size=20, face="bold", vjust=1, lineheight=0.6))
library(ggplot2)
library(ggplot2)
ggplot(data=manrep, aes(x=Date, y=Percent, group=Pop, colour=Pop, fill=Pop))+geom_line(size=1.5)+geom_point()+ylim(c(0,15))+scale_colour_manual(values=c("#3366CC","#CC66CC","#FF9900"))+scale_fill_manual(values=c("#3366CC","#CC66CC","#FF9900"))+theme(axis.text.x=element_text(angle=90, size=10, vjust=0.5))+ggtitle("Percent Brooders\nManchester")+theme(legend.title=element_blank())+theme(plot.title = element_text(size=20, face="bold", vjust=1, lineheight=0.6))
ggplot()+geom_density(data=outoys, aes(x=Length.mm, group=Tray_1, colour=Tray_1, fill=Tray_1),alpha=0.3)+geom_density(data=endoys, aes(x=Length.mm, group=Tray_1, colour=Tray_1, fill=Tray_1),alpha=0.3)+scale_colour_manual(values=c("#3366CC","#CC66CC","#FF9900"))+scale_fill_manual(values=c("#3366CC","#CC66CC","#FF9900"))+ggtitle("Size Comparison\nAugust 2013 vs. August 2014")
ggplot()+geom_density(data=outoys, aes(x=Length.mm, group=Tray_1, colour=Tray_1, fill=Tray_1),alpha=0.3)+geom_density(data=endoys, aes(x=Length.mm, group=Tray_1, colour=Tray_1, fill=Tray_1),alpha=0.3)+scale_colour_manual(values=c("#3366CC","#CC66CC","#FF9900"))+scale_fill_manual(values=c("#3366CC","#CC66CC","#FF9900"))+ggtitle("Size Comparison\nAugust 2013 vs. August 2014")
ggplot(aes(endoys,x=Length.mm)+(outoys,x=Size))+geom_density(aes(group=Tray_1, colour=Tray_1),alpha=0.3)+facet_wrap(~Tray_1, ncol=1)+scale_colour_manual(values=c("#3366CC","#CC66CC","#FF9900"))+scale_fill_manual(values=c("#3366CC","#CC66CC","#FF9900"))
ggplot(mansize, aes(Date,Length.mm, group=Tray_1, color=Tray_1))+geom_point()+geom_smooth(method=lm)+scale_colour_manual(values=c("#3366CC","#CC66CC","#FF9900"))
require(plyr)
require(ggplot2)
View(outman)
meanoutsizes<-ddply(outman,.(Tray_1),summarise, mean_size=mean(Size,na.rm=T))
View(meanoutsizes)
meanoutoyssizes<-ddply(outoys,.(Tray_1),summarise, mean_size=mean(Size,na.rm=T))
meanoutfidsizes<-ddply(outfid,.(Tray_1),summarise, mean_size=mean(Size,na.rm=T))
View(outoys)
View(outfid)
meanoutoyssizes<-ddply(outoys,.(Tray_1),summarise, mean_size=mean(Length.mm,na.rm=T))
View(meanoutoyssizes)
View(meanoutfidsizes)
View(meanoutsizes)
meanendmansizes<-ddply(endman,.(Tray_1),summarise, mean_size=mean(Length.mm,na.rm=T))
meanendoyssizes<-ddply(endoys,.(Tray_1),summarise, mean_size=mean(Length.mm,na.rm=T))
meanendfidsizes<-ddply(endfid,.(Tray_1),summarise, mean_size=mean(Length.mm,na.rm=T))
View(meanendfidsizes)
View(meanendmansizes)
View(meanendoyssizes)
require(plyr)
require(ggplot2)
require(scales)
require(grid)
require(gtable)
setwd("~/R/TempData/Temp-Data-And-Scripts")
brood<-read.csv("./data/Brood-numbers-all-2014.csv")
brood$Date<-as.Date(brood$Date, "%m/%d/%Y")
brood$arcperc<-asin(brood$Percent/100)
View(brood)
brood$arcperc<-asin(brood$Percent)
View(brood)
brood$arcperc<-asin(brood$Percent/100)
View(brood)
BroodANOVA<-aov(brood$arcperc~brood$Site+brood$Pop+brood$Site:brood$Pop,brood)
print(BroodANOVA)
broodTukey<-TukeyHSD(BroodANOVA)
print(broodTukey)
brood$arcperc<-glm(brood$Percent)
brood$arcperc<-asin(brood$Percent)
brood$arcperc<-asin(brood$Percent/100)
brood$arcperc<-asin(brood$Percent*100)
brood$arcperc<-asin(brood$Percent/100)
BroodANOVA<-aov(brood$arcperc~brood$Site+brood$Pop+brood$Site:brood$Pop,brood)
print(BroodANOVA)
broodTukey<-TukeyHSD(BroodANOVA)
print(broodTukey)
require(ggplot2)
require(plyr)
require(splitstackshape)
require(nparcomp)
require(PMCMR)
require(pastecs)
y1size=read.csv('./data/Size-outplant-end-all-2013-14.csv')
y1size$Date<-as.Date(y1size$Date, "%m/%d/%Y")
endy1<-ddply(y1size,.(Length.mm,Site,Pop,Tray,Sample,Area,Pop2),subset,Date>="2014-09-19")
View(`y1size`)
y1size$Pop2<-y1size$Pop
y1size$Pop2<-revalue(y1size$Pop2,c("1H"="H","2H"="H","4H"="H","1N"="N","2N"="N","4N"="N","1S"="S","2S"="S","4S"="S"))
endy1<-ddply(y1size,.(Length.mm,Site,Pop,Tray,Sample,Area,Pop2),subset,Date>="2014-09-19")
??glm
glmsize<-glm(endy1$Length.mm~endy1$Site+endy1$Pop2, family=poisson())
warnings()
glmsize<-glm(endy1$Length.mm~endy1$Site+endy1$Pop2, family=gaussian())
anova(glmsize)
summary(glmsize)
glmsize<-glm(endy1$Length.mm~endy1$Site+endy1$Pop2, family=poisson())
anova(glmsize)
summary(glmsize)
aovsize<-aov(endy1$Length.mm~endy1$Site+endy1$Pop2+endy1$Site:endy1$Pop2,endy1)
print(aovsize)
tukeysize<-TukeyHSD(aovsize)
print(tukeysize)
sizenemenyi3<-posthoc.kruskal.nemenyi.test(x=endy1$Length.mm,g=endy1$Site:endy1$Pop2, method="Tukey")
sizenemenyi3
fidsum<-summary(survfit(Surv(Death,Status)~Population,data=kmfid))
print(fidsum)
oyssum<-summary(survfit(Surv(Death,Status)~Population,data=kmoys))
print(oyssum)
dabsum<-summary(survfit(Surv(Death,Status)~Population,data=kmdab))
print(dabsum)
mansum<-summary(survfit(Surv(Death,Status)~Population,data=kmman))
print(mansum)
anova(fit,fit2,fit3,fit4)
survaov<-anova(fit,fit2,fit3,fit4)
TukeyHSD(survaov)
survaov<-aov(fit,fit2,fit3,fit4)
TukeyHSD(survaov)
summary(fit4)
manft<-coxph(Surv(Death,Status)~Population,data=kmman))
manft<-coxph(Surv(Death,Status)~Population,data=kmman)
anova(manft)
tukeyHSD(manft)
TukeyHSD(manft)
manaov<-anova(manft)
TukeyHSD(manaov)
kmall=read.csv("./data/KMdataAll.csv")
names(kmall)
allfit<-coxph(Surv(Death,Status)~Population+Site+Population:Site,data=kmall)
allaov<-anova(allfit)
TukeyHSD(allaov)
allaov
allfit<-coxph(Surv(Death,Status)~as.factor(Population+Site+Population:Site),data=kmall)
allfit<-coxph(Surv(Death,Status)~as.factor(Population)+as.factor(Site)+as.factor(Population):as.factor(Site),data=kmall)
allaov<-anova(allfit)
allaov
summary(allfit)
allfit<-coxph(Surv(Death,Status)~as.factor(Population)+as.factor(Site)+as.factor(Site):as.factor(Population),data=kmall)
allaov<-anova(allfit)
allaov
summary(allfit)
TukeyHSD(allaov)
TukeyHSD(allfit)
allfit<-coxph(Surv(Death,Status)~as.factor(Site)+as.factor(Population)+as.factor(Site):as.factor(Population),data=kmall)
allaov<-anova(allfit)
allaov
summary(allfit)
fitall2=with(kmall, survfit(Surv(Death,Status)~as.factor(Site)+as.factor(Population)+as.factor(Site):as.factor(Population)))
fitall2=with(kmall, survfit(Surv(Death,Status)~as.factor(Site)+as.factor(Population)))
anova(fitall2)
fitall2=with(kmall,Surv(Death,Status)~as.factor(Site)+as.factor(Population))
anova(fitall2)
fitall2=with(Surv(Death,Status)~as.factor(Site)+as.factor(Population),data=kmall)
anova(fitall2)
fitall2=(Surv(Death,Status)~as.factor(Site)+as.factor(Population),data=kmall)
oyssum<-summary(survfit(Surv(Death,Status)~Population,data=kmoys))
oyssurv<-survdiff(Surv(Death,Status)~Population,data=kmoys)
print(oyssurv)
fidsurv<-survdiff(Surv(Death,Status)~Population,data=kmfid)
print(fidsurv)
allsurv<-survdiff(Surv(Death,Status)~as.factor(Site)+as.factor(Population)+as.factor(Site):as.factor(Population),data=kmall)
print(allsurv)
allsurv<-survdiff(Surv(Death,Status)~as.factor(Site)+as.factor(Population)+as.factor(Site):as.factor(Population),data=kmall)
allsurv<-survdiff(Surv(Death,Status)~Site+Population+Site:Population,data=kmall)
allsurv<-survdiff(Surv(Death,Status)~Site+Population,data=kmall)
print(allsurv)
plot(allfit)
allfit<-coxph(Surv(Death,Status)~as.factor(Site)+as.factor(Population)+as.factor(Site):as.factor(Population),data=kmall)
plot(allfit)
thingy<-cox.zph(allfit)
plot(thingy)
plot(thingy[5])
plot(allsurv)
allfit<-coxph(Surv(Death,Status)~as.factor(Site)+as.factor(Population)+as.factor(Site):as.factor(Population),data=kmall)
allaov<-anova(allfit)
allaov
summary(allfit)
allfit<-coxph(Surv(Death,Status)~Site+Population+Site:Population,data=kmall)
allaov<-anova(allfit)
allaov
summary(allfit)
sizenemenyi3<-posthoc.kruskal.nemenyi.test(x=endy1$Length.mm,g=endy1$Site:endy1$Pop2, method="Tukey")
sizenemenyi3
sizenemenyi1<-posthoc.kruskal.nemenyi.test(x=endy1$Length.mm,g=endy1$Site, method="Tukey")
sizenemenyi1
sizenemenyi2<-posthoc.kruskal.nemenyi.test(x=endy1$Length.mm,g=endy1$Pop2, method="Tukey")
sizenemenyi2
sizenemenyi3<-posthoc.kruskal.nemenyi.test(x=endy1$Length.mm,g=endy1$Site:endy1$Pop2, method="Tukey")
sizenemenyi3
table(sizenemenyi3)
data.frame(sizenemenyi3)
View(sizenemenyi3)
??write.csv
nemenyi3<-write.csv(sizenemenyi3,file="nemenyi.csv")
nemenyi3<-write.csv2(sizenemenyi3,file="nemenyi.csv")
nemenyi3<-write.csv2(sizenemenyi3,file="nemenyi.csv",row.names=T)
brood$arcperc<-asin(brood$Percent/100)
BroodANOVA<-aov(brood$arcperc~brood$Site+brood$Pop+brood$Site:brood$Pop,brood)
print(BroodANOVA)
broodTukey<-TukeyHSD(BroodANOVA)
print(broodTukey)
broodersizes<-read.csv('./data/Broodersizes.csv')
broodersizes$Date<-as.Date(broodersizes$Date,"%m/%d/%Y")
View(broodersizes)
brdszaov<-(broodersizes$Size~broodersizes$Site+broodersizes$Population+broodersizes$Site:broodersizes$Population,data=broodersizes)
brdszaov<-(broodersizes$Size~broodersizes$Site+broodersizes$Population+broodersizes$Site:broodersizes$Population,broodersizes)
brdszaov<-aov(broodersizes$Size~broodersizes$Site+broodersizes$Population+broodersizes$Site:broodersizes$Population,broodersizes)
brdszaov
print(brdszaov)
tkbrdsz<-TukeyHSD(brdszaov)
print(tkbrdsz)
